// /////////////////////////////////////////////////////////////////
// Generated by dtkPluginGenerator
// /////////////////////////////////////////////////////////////////

#include "vtkDataFibers.h"

#include <dtkCore/dtkAbstractDataFactory.h>

#include "vtkSmartPointer.h"
#include "vtkPolyData.h"
#include "vtkPolyDataReader.h"
#include "vtkPolyDataWriter.h"

// /////////////////////////////////////////////////////////////////
// vtkDataFibersPrivate
// /////////////////////////////////////////////////////////////////

class vtkDataFibersPrivate
{
public:
	vtkSmartPointer<vtkPolyData> data;
};

// /////////////////////////////////////////////////////////////////
// vtkDataFibers
// /////////////////////////////////////////////////////////////////

vtkDataFibers::vtkDataFibers(void) : dtkAbstractData(), d(new vtkDataFibersPrivate)
{
    d->data = 0;
}

vtkDataFibers::~vtkDataFibers(void)
{
    delete d;
    d = 0;
}

bool vtkDataFibers::registered(void)
{
    return dtkAbstractDataFactory::instance()->registerDataType("vtkDataFibers", createVtkDataFibers);
}

QString vtkDataFibers::description(void) const
{
    return "vtkDataFibers";
}

bool vtkDataFibers::read(const QString& file)
{
	vtkPolyDataReader* reader = vtkPolyDataReader::New();
	reader->SetFileName( file.toAscii().constData() );
	if (!reader->IsFilePolyData() )
		return false;
	
	reader->Update();
	d->data = reader->GetOutput();
	return true;
}

bool vtkDataFibers::write(const QString& file)
{
	if (!d->data)
		return false;
	vtkPolyDataWriter* writer = vtkPolyDataWriter::New();
	writer->SetFileName( file.toAscii().constData() );
	writer->SetInput( d->data );
	writer->SetFileTypeToBinary();
	writer->Update();
	return true;
}

void vtkDataFibers::setData(void *data)
{
	if (vtkPolyData *dataset = dynamic_cast<vtkPolyData*>(static_cast<vtkObject*>(data)))
		d->data = dataset;
}

void *vtkDataFibers::data(void)
{
	return d->data;
}

// /////////////////////////////////////////////////////////////////
// Type instanciation
// /////////////////////////////////////////////////////////////////

dtkAbstractData *createVtkDataFibers(void)
{
    return new vtkDataFibers;
}
